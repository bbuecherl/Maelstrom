/**
 * Maelstrom v0.0.1-1403191230
 * https://github.com/bbuecherl/Maelstrom/
 * by Bernhard Buecherl http://bbuecherl.de/
 */
!function(a){"use strict";"undefined"!=typeof"".trim&&(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")}),Object.prototype.watch||Object.defineProperty(Object.prototype,"watch",{enumerable:!1,configurable:!0,writable:!1,value:function(a,b){var c=this[a],d=c,e=function(){return d},f=function(e){return c=d,d=b.call(this,a,c,e)};delete this[a]&&Object.defineProperty(this,a,{get:e,set:f,enumerable:!0,configurable:!0})}}),Object.prototype.unwatch||Object.defineProperty(Object.prototype,"unwatch",{enumerable:!1,configurable:!0,writable:!1,value:function(a){var b=this[a];delete this[a],this[a]=b}}),Array.prototype.min=function(){return Math.min.apply(this,this)};var b=document,c=b.createElement.bind(b),d=b.createDocumentFragment.bind(b),e=b.createTextNode.bind(b),f=function(a){for(var b=[],c=[],d=a.split("\n"),e=0,f=d.length,h=0;f>e;++e)h=g(d[e]),0!==d[e].length&&h!==d[e].length&&(b.push(d[e]),c.push(h));return{l:b,o:c}},g=function(a){for(var b=0,c=a.length;c>b;++b)if(" "!=a[b]&&"	"!=a[b])return b;return a.length},h=function(a){return a.split(/#|\.|\(|\{| /g)},i=function(a,b){var c=a.indexOf(b);return-1!=c?[a.slice(0,c),a.slice(c+b.length)]:!1},j=function(a,b){for(var c=b.split("."),d=0;d<c.length;++d){if(!a.hasOwnProperty(c[d]))return!1;a=a[c[d]]}return!0},k=function(a,b){for(var c=b.split("."),d=0;d<c.length;++d)a=a[c[d]];return a},l=function(a){for(var b={},c=[],d=0,e=0;d<a.length;++d)","==a[d]&&(c.push(a.slice(e,d-1).trim()),e=d+1);for(c.push(a.slice(e)),e=d,d=0;d<c.length;++d)0!==c[d].length&&(e=c[d].split("="),b[e[0].trim()]=e[1].trim().slice(1,e[1].length-1).trim());return b},m=function(a,b,c){b=b.split("-");for(var d=0;d<b.length;++d)0!==d&&(b[d]=b.slice(0,1).toUpperCase()+b.slice(1));b.join(""),a.style[b]=c},n=["br","hr","input","img","meta"],o=function(a){return"undefined"==typeof a?!1:-1!=n.indexOf(a)},p=function(a,b,c){for(var d=c.o.min(),e=[],f=[],g=[],h=0,i=0;i<c.l.length;++i)d==c.o[i]?i!==h&&(g.push(new s(c.l[h],{l:e,o:f},a,b)),e=[],f=[],h=i):(e.push(c.l[i]),f.push(c.o[i]));return g.push(new s(c.l[h],{l:e,o:f},a,b)),g},q={compile:function(a,b){var c=new r(a);return"undefined"!=typeof b&&c.subscribe(b),c}},r=function(a){this.fragments=[],this.listeners={},this.subscription=!1,this.childs=p(this,this,f(a))};r.prototype.append=function(a){if("undefined"==typeof this.frag){this.frag=d();for(var b=0,c=this.childs.length;c>b;++b)this.frag.appendChild(this.childs[b].domElement)}return a.appendChild(this.frag),this},r.prototype.remove=function(a){return"undefined"!=typeof this.frag&&a.removeChild(this.frag),this},r.prototype.on=function(a,b){return this.listeners.hasOwnProperty(a)||(this.listeners[a]=[]),this.listeners[a].push(b),this},r.prototype.off=function(a,b){if(this.listeners.hasOwnProperty(a)){var c=this.listeners[a].indexOf(b);-1!=c&&delete this.listeners[a][c]}return this},r.prototype.trigger=function(a,b){if(this.listeners.hasOwnProperty(a))for(var c=0;c<this.listeners[a].length;++c)this.listeners[a][c](b);return this},r.prototype.render=function(a){for(var b in this.listeners)j(a,b)&&this.trigger(b,k(a,b));return this},r.prototype.subscribe=function(a){var b,c,d,e,f;if(this.subscription)for(var g in this.listeners){for(f=g.split("."),b=this.subscription,c=this.subscription,d=0;d<f.length;++d){if(!c.hasOwnProperty(f[d])){e=!1;break}b=c,e=!0,c=c[f[d]]}e&&b.unwatch(f[f.length-1])}if(this.subscription=a,this.subscription){for(var h in this.listeners){for(f=h.split("."),b=this.subscription,c=this.subscription,d=0;d<f.length;++d){if(!c.hasOwnProperty(f[d])){e=!1;break}b=c,e=!0,c=c[f[d]]}e&&!function(a){var c=f[f.length-1],d=h;b.watch(c,function(a,b,c){return this.trigger(d,c),c}.bind(a))}(this)}this.render(this.subscription)}return this},r.prototype.unsubscribe=function(){return this.subscribe(!1)};var s=function(a,b,f,g){this.line=a.trim();var j,k,n,q,r,s,t;if(g.fragments.push(this),"|"==this.line[0])this.domElement=d(),k=this.line.slice(1);else{b.l.length>0&&(this.childs=p(this,g,b)),j=h(this.line),k=this.line.slice(j[0].length),t=j[0].toLowerCase(),this.domElement=c(t);for(var u="";k.length>0;)if("#"==k[0])j=h(k.slice(1)),k=k.slice(j[0].length+1).trim(),this.domElement.id=j[0];else{if("."!=k[0])break;j=h(k.slice(1)),k=k.slice(j[0].length+1).trim(),u+=j[0]}if(0!==u.length&&(this.domElement.className=u.trim()),k.length>0&&"("==k[0]){for(q=1;q<k.length&&")"!=k[q];++q);j=k.slice(1,q).trim(),k=k.slice(q+1),n=l(j);for(r in n)n[r].replace("[[$","").length!=n[r].length?(s=n[r].split("[[$")[1].split("]]")[0],function(a){var b=s,c=r,d=n[c];g.on(s,function(a){this.domElement.setAttribute(c,d.replace("[[$"+b+"]]",a))}.bind(a))}(this)):this.domElement.setAttribute(r,n[r]);this.attrs=j}if(k.length>0&&"{"==k[0]){for(q=1;q<k.length&&"}"!=k[q];++q);j=k.slice(1,q).trim(),k=k.slice(q+1),n=l(j);for(var v in n)n[v].replace("[[$","").length!=n[v].length?(s=n[v].split("[[$")[1].split("]]")[0],function(a){var b=s,c=v,d=n[v];g.on(s,function(a){m(this.domElement,c,d.replace("[[$"+b+"]]",a))}.bind(a))}(this)):m(this.domElement,v,n[v]);this.styles=j}}if(k.length>0&&!o(t)){for(;j=i(k,"[[$");)s=e(j[0]),this.domElement.appendChild(s),j=i(j[1],"]]"),s=e("[[$"+j[0]+"]]"),this.domElement.appendChild(s),function(){var a=s,b=j[0];g.on(b,function(b){a.textContent=b})}(),k=j[1];s=e(k),this.domElement.appendChild(s)}if("undefined"!=typeof this.childs)for(q=0;q<this.childs.length;++q)this.domElement.appendChild(this.childs[q].domElement)};a.Maelstrom=q}(window);